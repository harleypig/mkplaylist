# Default pre-commit configuration for mkplaylist
# This configuration only checks code without making changes

repos:
  # Branch protection hook - runs first to fail fast
  - repo: local
    hooks:
      - id: no-commit-to-master
        name: Prevent commits to master/main branch
        entry: scripts/no-commit-to-master.sh
        language: script
        pass_filenames: false
        # This hook runs regardless of which files are being committed
        # It checks the current branch name and blocks commits to master/main

  - repo: local
    hooks:
      - id: check-trailing-whitespace
        name: Check for trailing whitespace
        entry: bash -c 'find . -type f -not -path "*/\.*" -not -path "*/venv/*" -exec grep -l "[[:space:]]$" {} \; | grep -v "\.md$" && echo "Trailing whitespace found" && exit 1 || exit 0'
        language: system
        types: [text]
        
      - id: check-end-of-file
        name: Check for missing final newline
        entry: bash -c 'find . -type f -not -path "*/\.*" -not -path "*/venv/*" -exec sh -c "if [ -n \"$(tail -c 1 \"{}\")" ]; then echo \"{}\" && exit 1; fi" \; || exit 0'
        language: system
        types: [text]

  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v5.0.0
    hooks:
      - id: check-yaml
      - id: check-added-large-files
      - id: check-toml
      - id: check-merge-conflict
      - id: debug-statements
      - id: check-case-conflict

  - repo: https://github.com/pycqa/flake8
    rev: 7.2.0
    hooks:
      - id: flake8
        additional_dependencies: []
        # Use the project's .flake8 configuration

  - repo: https://github.com/pycqa/isort
    rev: 6.0.1
    hooks:
      - id: isort
        args: [ --check, --jobs=-1 ]
        # Only check, don't modify, use all cpus

  - repo: https://github.com/psf/black
    rev: 25.1.0
    hooks:
      - id: black
        args: [--check, --diff]
        # Only check, don't modify
        # Use the project's line length settings

  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.15.0
    hooks:
      - id: mypy
        additional_dependencies:
          - types-requests
          - types-setuptools
        # Only check, don't modify
        args: [--no-strict-optional, --ignore-missing-imports]

# Configuration is compatible with existing .flake8 and .style.yapf files
# This configuration only performs checks and does not modify any files
